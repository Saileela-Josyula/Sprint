package com.cg.mts.repository;

import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.PersistenceUnit;

import org.springframework.stereotype.Repository;

import com.cg.mts.entities.CourierOfficeOutlet;
import com.cg.mts.exception.OutletNotFoundException;
@Repository
public class OfficeOutletDaoImpl implements IOfficeOutletDao {

	@PersistenceUnit
	private EntityManagerFactory emf;
	@Override
	public void addNewOffice(CourierOfficeOutlet officeoutlet) {
		EntityManager em=emf.createEntityManager();
		em.getTransaction().begin();
		em.persist(officeoutlet);
		em.getTransaction().commit();
		em.close();
		
	}

	@Override
	public void removeNewOffice(CourierOfficeOutlet officeoutlet) {
		EntityManager em=emf.createEntityManager();
		em.getTransaction().begin();
		em.remove(officeoutlet);
		em.getTransaction().commit();
		em.close();
		
	}

	@Override
	public CourierOfficeOutlet getOfficeInfo(int officeid) throws OutletNotFoundException {
		EntityManager em=emf.createEntityManager();
		CourierOfficeOutlet outlet = em.find(CourierOfficeOutlet.class, officeid);
		em.close();
		if(outlet==null)
			throw new OutletNotFoundException("Outlet does not exists");
		else 
			return outlet;
	}

	@Override
	public List<CourierOfficeOutlet> getAllOfficesData() {
		EntityManager em=emf.createEntityManager();
		List<CourierOfficeOutlet> outlets = em.createQuery("Select t from officeoutlet t").getResultList();
		em.close();
		return outlets;
	}

}
